SELECT esd.EXTERNAL_SYSTEM_ID, co.CUSTOMER_ORDER_ID, vi.PROCESS_INST_ID
  FROM EXTERNAL_SYSTEM_DATA esd
       LEFT OUTER JOIN customer_order co
          ON esd.OWNER_ID = co.CUSTOMER_ORDER_ID
       LEFT OUTER JOIN variable_instance vi
          ON TO_CHAR (co.CUSTOMER_ORDER_ID) = vi.VARIABLE_VALUE
 WHERE     vi.PROCESS_INST_ID IN (SELECT PROCESS_INSTANCE_ID
                                    FROM activity_instance
                                   WHERE     ACTIVITY_ID IN (SELECT work_id
                                                               FROM WORK
                                                              WHERE work_name =
                                                                       'Activate TNs in CNUM')
                                         AND STATUS_CD = 3
                                         AND START_DT >= SYSDATE - 365)
       AND co.CMPLT_DATE IS NULL
       AND esd.EXTERNAL_SYSTEM_NAME = 'NETWORK_SYSTEM'
       AND OWNER_TYPE = 'ORDER'

select dn.directory_number,da.value from directory_number dn JOIN DN_ATTRIBUTE da ON da.DIRECTORY_NUMBER_ID = dn.DIRECTORY_NUMBER_ID
where da.directory_number_id  in
(select owner_id from customer_order_item where customer_order_id in( 1044376) and owner_type='DIRECTORY_NUMBER') 
and NAME='NT_ORDER_ID'


SELECT coi.customer_order_id,
         vi.PROCESS_INST_ID,
         da.VALUE as CNUM_ID,
         COUNT (coi.CUSTOMER_ORDER_ID) TN_COUNT
    FROM DIRECTORY_NUMBER dn
         JOIN CUSTOMER_ORDER_ITEM coi ON dn.DIRECTORY_NUMBER_ID = coi.OWNER_ID
         JOIN EXTERNAL_SYSTEM_DATA esd ON coi.CUSTOMER_ORDER_ID = esd.OWNER_ID
         JOIN CUSTOMER_ORDER co ON coi.CUSTOMER_ORDER_ID = co.CUSTOMER_ORDER_ID
         JOIN VARIABLE_INSTANCE vi
            ON TO_CHAR (co.CUSTOMER_ORDER_ID) = vi.VARIABLE_VALUE
         JOIN DN_ATTRIBUTE da ON da.DIRECTORY_NUMBER_ID = dn.DIRECTORY_NUMBER_ID   
   WHERE     vi.PROCESS_INST_ID IN (SELECT PROCESS_INSTANCE_ID
                                      FROM ACTIVITY_INSTANCE
                                     WHERE     ACTIVITY_ID IN (SELECT WORK_ID
                                                                 FROM WORK
                                                                WHERE WORK_NAME =
                                                                         'Activate TNs in CNUM')
                                           AND STATUS_CD = 3
                                           AND START_DT >= SYSDATE - 365)
         AND co.CMPLT_DATE IS NULL
         AND esd.EXTERNAL_SYSTEM_NAME = 'NETWORK_SYSTEM'
         AND esd.OWNER_TYPE = 'ORDER'
         AND coi.OWNER_TYPE = 'DIRECTORY_NUMBER'
         AND da.NAME='NT_ORDER_ID'
GROUP BY coi.CUSTOMER_ORDER_ID,da.VALUE, vi.PROCESS_INST_ID

SELECT coi.customer_order_id,
         vi.PROCESS_INST_ID,
         da.VALUE as CNUM_ID,
         COUNT (coi.CUSTOMER_ORDER_ID) TN_COUNT
    FROM DIRECTORY_NUMBER dn
         JOIN CUSTOMER_ORDER_ITEM coi ON dn.DIRECTORY_NUMBER_ID = coi.OWNER_ID
         JOIN EXTERNAL_SYSTEM_DATA esd ON coi.CUSTOMER_ORDER_ID = esd.OWNER_ID
         JOIN CUSTOMER_ORDER co ON coi.CUSTOMER_ORDER_ID = co.CUSTOMER_ORDER_ID
         JOIN VARIABLE_INSTANCE vi
            ON TO_CHAR (co.CUSTOMER_ORDER_ID) = vi.VARIABLE_VALUE
         JOIN DN_ATTRIBUTE da ON da.DIRECTORY_NUMBER_ID = dn.DIRECTORY_NUMBER_ID
         JOIN ACTIVITY_INSTANCE ai ON vi.PROCESS_INST_ID = ai.PROCESS_INSTANCE_ID
         JOIN WORK w ON ai.ACTIVITY_ID = w.WORK_ID
    WHERE w.WORK_NAME = 'Activate TNs in CNUM'
         AND ai.STATUS_CD = 3
         AND ai.START_DT >= SYSDATE - 365
         AND co.CMPLT_DATE IS NULL
         AND esd.EXTERNAL_SYSTEM_NAME = 'NETWORK_SYSTEM'
         AND esd.OWNER_TYPE = 'ORDER'
         AND coi.OWNER_TYPE = 'DIRECTORY_NUMBER'
         AND da.NAME='NT_ORDER_ID'
GROUP BY coi.CUSTOMER_ORDER_ID,da.VALUE, vi.PROCESS_INST_ID

SELECT esd.EXTERNAL_SYSTEM_ID ENGG_ORDER,
         coi.customer_order_id,
         vi.PROCESS_INST_ID,
         da.VALUE as CNUM_ID,
         COUNT (coi.CUSTOMER_ORDER_ID) TN_COUNT
    FROM DIRECTORY_NUMBER dn
         JOIN CUSTOMER_ORDER_ITEM coi ON dn.DIRECTORY_NUMBER_ID = coi.OWNER_ID
         JOIN EXTERNAL_SYSTEM_DATA esd ON coi.CUSTOMER_ORDER_ID = esd.OWNER_ID
         JOIN CUSTOMER_ORDER co ON coi.CUSTOMER_ORDER_ID = co.CUSTOMER_ORDER_ID
         JOIN VARIABLE_INSTANCE vi
            ON TO_CHAR (co.CUSTOMER_ORDER_ID) = vi.VARIABLE_VALUE
         JOIN DN_ATTRIBUTE da ON da.DIRECTORY_NUMBER_ID = dn.DIRECTORY_NUMBER_ID
         JOIN ACTIVITY_INSTANCE ai ON vi.PROCESS_INST_ID = ai.PROCESS_INSTANCE_ID
         JOIN WORK w ON ai.ACTIVITY_ID = w.WORK_ID
    WHERE w.WORK_NAME = 'Activate TNs in CNUM'
         AND ai.STATUS_CD = 3
         AND ai.START_DT >= SYSDATE - 365
         AND co.CMPLT_DATE IS NULL
         AND esd.EXTERNAL_SYSTEM_NAME = 'NETWORK_SYSTEM'
         AND esd.OWNER_TYPE = 'ORDER'
         AND coi.OWNER_TYPE = 'DIRECTORY_NUMBER'
         AND da.NAME='NT_ORDER_ID'
GROUP BY esd.EXTERNAL_SYSTEM_ID,coi.CUSTOMER_ORDER_ID,da.VALUE, vi.PROCESS_INST_ID

https://ngwm.qintra.com/orderdashboard/?exclusiveModule=orderDashboard
